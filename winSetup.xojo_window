#tag WindowBegin Window winSetup   BackColor       =   &cFFFFFF00   Backdrop        =   0   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   FullScreenButton=   False   HasBackColor    =   False   Height          =   394   ImplicitInstance=   True   LiveResize      =   "True"   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   0   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   1   Resizeable      =   False   Title           =   "Installer"   Visible         =   True   Width           =   600   Begin PagePanel ppWizard      AutoDeactivate  =   False      Enabled         =   True      Height          =   368      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   207      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      PanelCount      =   4      Panels          =   ""      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      Top             =   13      Transparent     =   True      Value           =   0      Visible         =   True      Width           =   373      Begin PushButton pbFinish         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Finish"         Default         =   True         Enabled         =   False         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   500         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   4         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   354         Transparent     =   True         Underline       =   False         Visible         =   True         Width           =   80      End      Begin Label lblProgress         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   102         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   221         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Multiline       =   True         Scope           =   0         Selectable      =   False         TabIndex        =   5         TabPanelIndex   =   4         TabStop         =   True         Text            =   "Please wait for the installer to finish processing your request."         TextAlign       =   0         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   28         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   343      End      Begin PushButton pbContinue         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Continue"         Default         =   True         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   500         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   3         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   354         Transparent     =   True         Underline       =   False         Visible         =   True         Width           =   80      End      Begin PushButton pbGoBack         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   True         Caption         =   "Go Back"         Default         =   False         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   408         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   3         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   354         Transparent     =   True         Underline       =   False         Visible         =   True         Width           =   80      End      Begin RadioButton radioOption3         AutoDeactivate  =   True         Bold            =   False         Caption         =   "Untitled"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   281         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   3         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   215         Transparent     =   True         Underline       =   False         Value           =   False         Visible         =   False         Width           =   299      End      Begin RadioButton radioOption2         AutoDeactivate  =   True         Bold            =   False         Caption         =   "Untitled"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   281         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   3         TabPanelIndex   =   3         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   184         Transparent     =   True         Underline       =   False         Value           =   False         Visible         =   False         Width           =   299      End      Begin RadioButton radioOption1         AutoDeactivate  =   True         Bold            =   False         Caption         =   "Untitled"         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   281         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   4         TabPanelIndex   =   3         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   151         Transparent     =   True         Underline       =   False         Value           =   True         Visible         =   True         Width           =   299      End      Begin Label lblDescription         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   111         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   221         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Multiline       =   True         Scope           =   0         Selectable      =   False         TabIndex        =   5         TabPanelIndex   =   3         TabStop         =   True         Text            =   "Please choose an option below and click the Continue button to proceed."         TextAlign       =   0         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   28         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   343      End      Begin PushButton pbAccept         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Accept"         Default         =   True         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   500         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   354         Transparent     =   True         Underline       =   False         Visible         =   True         Width           =   80      End      Begin PushButton pbQuit         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   True         Caption         =   "Quit"         Default         =   False         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   408         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   354         Transparent     =   True         Underline       =   False         Visible         =   True         Width           =   80      End      Begin TextArea txtClickWrap         AcceptTabs      =   False         Alignment       =   0         AutoDeactivate  =   True         AutomaticallyCheckSpelling=   True         BackColor       =   &cFFFFFF00         Bold            =   False         Border          =   True         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Format          =   ""         Height          =   311         HelpTag         =   ""         HideSelection   =   True         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   207         LimitText       =   0         LineHeight      =   0.0         LineSpacing     =   1.0         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Mask            =   ""         Multiline       =   True         ReadOnly        =   True         Scope           =   0         ScrollbarHorizontal=   False         ScrollbarVertical=   True         Styled          =   True         TabIndex        =   8         TabPanelIndex   =   2         TabStop         =   True         Text            =   "Click the Accept button to continue with installation or click Quit to exit."         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   13         Transparent     =   True         Underline       =   False         UseFocusRing    =   True         Visible         =   True         Width           =   373      End      Begin PushButton pbPrint         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   True         Caption         =   "Print..."         Default         =   False         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   207         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   9         TabPanelIndex   =   2         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   354         Transparent     =   True         Underline       =   False         Visible         =   True         Width           =   80      End      Begin Label lblDescription1         AutoDeactivate  =   True         Bold            =   False         DataField       =   ""         DataSource      =   ""         Enabled         =   True         Height          =   111         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   221         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Multiline       =   True         Scope           =   0         Selectable      =   False         TabIndex        =   0         TabPanelIndex   =   1         TabStop         =   True         Text            =   "The installer will now prompt you with confirmation for administrator privileges and restart. Please click Continue to install or Quit to cancel the installation process."         TextAlign       =   0         TextColor       =   &c00000000         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   28         Transparent     =   False         Underline       =   False         Visible         =   True         Width           =   343      End      Begin PushButton pbQuitNow         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   True         Caption         =   "Quit"         Default         =   False         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   408         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   1         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   354         Transparent     =   True         Underline       =   False         Visible         =   True         Width           =   80      End      Begin PushButton pbRestart         AutoDeactivate  =   True         Bold            =   False         ButtonStyle     =   0         Cancel          =   False         Caption         =   "Continue"         Default         =   True         Enabled         =   True         Height          =   20         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "ppWizard"         Italic          =   False         Left            =   500         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   2         TabPanelIndex   =   1         TabStop         =   True         TextFont        =   "System"         TextSize        =   0.0         TextUnit        =   0         Top             =   354         Transparent     =   True         Underline       =   False         Visible         =   True         Width           =   80      End   End   Begin Canvas Canvas2      AcceptFocus     =   False      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      Height          =   14      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   -8      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      Top             =   344      Transparent     =   True      UseFocusRing    =   False      Visible         =   True      Width           =   619      Begin Rectangle Rectangle1         AutoDeactivate  =   True         BorderWidth     =   2.0         BottomRightColor=   &cFFFFFF00         Enabled         =   True         FillColor       =   &cFFFFFF00         Height          =   3         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "Canvas2"         Left            =   -8         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   True         LockTop         =   True         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         Top             =   344         TopLeftColor    =   &cA0A0A000         Transparent     =   True         Visible         =   True         Width           =   619      End   End   Begin Canvas Canvas1      AcceptFocus     =   False      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      Height          =   212      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      Top             =   122      Transparent     =   True      UseFocusRing    =   True      Visible         =   False      Width           =   580      Begin ShellProgress shellInstall         AcceptFocus     =   False         AcceptTabs      =   True         AutoDeactivate  =   True         BackColor       =   &cFFFFFF00         Backdrop        =   0         Console         =   False         DoubleBuffer    =   False         Enabled         =   True         EraseBackground =   True         HasBackColor    =   False         Height          =   189         HelpTag         =   ""         InitialParent   =   "Canvas1"         Left            =   221         LockBottom      =   True         LockedInPosition=   False         LockLeft        =   True         LockRight       =   True         LockTop         =   True         nMilliTimeout   =   0         Scope           =   0         Seconds         =   0         Segments        =   0         sType           =   ""         TabIndex        =   0         TabPanelIndex   =   0         TabStop         =   True         Timeout         =   60         Top             =   134         Transparent     =   True         UseFocusRing    =   False         Visible         =   True         Width           =   339      End   End   Begin Canvas Canvas3      AcceptFocus     =   False      AcceptTabs      =   False      AutoDeactivate  =   True      Backdrop        =   0      DoubleBuffer    =   False      Enabled         =   True      Height          =   376      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   14      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   True      LockRight       =   False      LockTop         =   True      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      Top             =   13      Transparent     =   True      UseFocusRing    =   False      Visible         =   True      Width           =   188      Begin Rectangle rectLogo         AutoDeactivate  =   False         BorderWidth     =   1.0         BottomRightColor=   &cFFFFFF0F         Enabled         =   True         FillColor       =   &c00000000         Height          =   362         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "Canvas3"         Left            =   15         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   0         TabPanelIndex   =   0         Top             =   14         TopLeftColor    =   &cA0A0A000         Transparent     =   True         Visible         =   True         Width           =   177      End      Begin Canvas cnvLogo         AcceptFocus     =   False         AcceptTabs      =   False         AutoDeactivate  =   True         Backdrop        =   383947154         DoubleBuffer    =   False         Enabled         =   True         Height          =   360         HelpTag         =   ""         Index           =   -2147483648         InitialParent   =   "Canvas3"         Left            =   16         LockBottom      =   False         LockedInPosition=   False         LockLeft        =   True         LockRight       =   False         LockTop         =   True         Scope           =   0         TabIndex        =   1         TabPanelIndex   =   0         TabStop         =   True         Top             =   15         Transparent     =   True         UseFocusRing    =   False         Visible         =   True         Width           =   175      End   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Open()		  // Allow only one instance of the application in memory		  #If TargetWin32		    App.Instance = New Mutex(App.ExecutableFile.Name)		    If not App.Instance.TryEnter then		      Quit		    End if		    		    // Adjust controls for Windows platform		    // Cycle through the controls		    Dim c As Control		    Dim i As Integer		    For i = 0 to Self.ControlCount -1		      c = Self.Control(i)		      		      // Adjust pushbutton height		      If c.Name.Left(2) = "pb" Then		        Dim pb As PushButton		        pb = PushButton(c)		        pb.height = 24		      End If		    Next		  #EndIf		  		  // Leave memory on mac when closing window		  App.AutoQuit = True		  		  // Check for libs folder		  If Not GetAppFolder().Child("libs").Exists Then		    Call MsgBox("Installer cannot continue because of missing libs folder. Click OK to quit.", 16)		    Quit		  End If		  		  // Load logo if present in libs folder		  If GetAppFolder().Child("libs").Child("logo.jpg").Exists Then		    cnvLogo.Backdrop = Picture.Open(GetAppFolder().Child("libs").Child("logo.jpg"))		  End If		  		  // Capture user environment folders		  Self.jsonShortCodes = CaptureUserEnv()		  shellInstall.jsonShortCodes = Self.jsonShortCodes		  		  // Start Installer		  LoadInstaller		  		  // Go to license aggrement page		  If IsAdmin() Then		    ppWizard.Value = 1		  Else		    #If TargetMacOS		      MsgBox "Cannot run without admin rights."		      Quit		    #EndIf		  End If		  		End Sub	#tag EndEvent	#tag Method, Flags = &h0		Function CaptureUserEnv() As JSONItem		  // Capture the user environment to temp file		  // Get user folder preferences		  Dim jsonUFP As New JSONItem		  #If TargetMacOS		    Dim fi As FolderItem = SpecialFolder.SharedDocuments.Child(".com.virtuosoft.install.json")		    jsonUFP.value("Installer") = App.ExecutableFile.Parent.Parent.Parent.Parent.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Applications") = SpecialFolder.Applications.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("ApplicationData") = SpecialFolder.ApplicationData.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Bin") = SpecialFolder.Bin.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    //jsonUFP.value("Desktop") = SpecialFolder.Desktop.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    //jsonUFP.value("Documents") = SpecialFolder.Documents.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Etc") = SpecialFolder.Etc.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Favorites") = SpecialFolder.Favorites.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Fonts") = SpecialFolder.Fonts.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("History") = SpecialFolder.History.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Home") = SpecialFolder.Home.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("History") = SpecialFolder.History.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("InternetCache") = SpecialFolder.InternetCache.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Library") = SpecialFolder.Library.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Mount") = SpecialFolder.Mount.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    //jsonUFP.value("Music") = SpecialFolder.Music.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Pictures") = SpecialFolder.Pictures.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Preferences") = SpecialFolder.Preferences.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Printers") = SpecialFolder.Printers.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("RecentItems") = SpecialFolder.RecentItems.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("SBin") = SpecialFolder.SBin.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("SharedApplicationData") = SpecialFolder.SharedApplicationData.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("SharedDocuments") = SpecialFolder.SharedDocuments.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("SharedPreferences") = SpecialFolder.SharedPreferences.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("System") = SpecialFolder.System.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Temporary") = SpecialFolder.Temporary.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Trash") = SpecialFolder.Trash.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("UserBin") = SpecialFolder.UserBin.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("UserHome") = SpecialFolder.UserHome.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("UserLibrary") = SpecialFolder.UserLibrary.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("UserSBin") = SpecialFolder.UserSBin.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("Var") = SpecialFolder.Variable.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		    jsonUFP.value("VarLog") = SpecialFolder.VarLog.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ")		  #Else		    Dim fi As FolderItem = SpecialFolder.SharedApplicationData.Child("com.virtuosoft.install.json")		    jsonUFP.value("Installer") = App.ExecutableFile.Parent.AbsolutePath		    jsonUFP.value("AppleMenu") = SpecialFolder.AppleMenu.AbsolutePath		    jsonUFP.value("StartMenu") = SpecialFolder.AppleMenu.AbsolutePath		    jsonUFP.value("Applications") = SpecialFolder.Applications.AbsolutePath		    jsonUFP.value("ApplicationData") = SpecialFolder.ApplicationData.AbsolutePath		    jsonUFP.value("Cookies") = SpecialFolder.Cookies.AbsolutePath		    jsonUFP.value("Desktop") = SpecialFolder.Desktop.AbsolutePath		    jsonUFP.value("Documents") = SpecialFolder.Documents.AbsolutePath		    jsonUFP.value("Extensions") = SpecialFolder.Extensions.AbsolutePath		    jsonUFP.value("Favorites") = SpecialFolder.Favorites.AbsolutePath		    jsonUFP.value("Fonts") = SpecialFolder.Fonts.AbsolutePath		    jsonUFP.value("History") = SpecialFolder.History.AbsolutePath		    jsonUFP.value("InternetCache") = SpecialFolder.InternetCache.AbsolutePath		    jsonUFP.value("Music") = SpecialFolder.Music.AbsolutePath		    jsonUFP.value("NetworkPlaces") = SpecialFolder.NetworkPlaces.AbsolutePath		    jsonUFP.value("Pictures") = SpecialFolder.Pictures.AbsolutePath		    jsonUFP.value("Preferences") = SpecialFolder.Preferences.AbsolutePath		    jsonUFP.value("Printers") = SpecialFolder.Printers.AbsolutePath		    jsonUFP.value("RecentItems") = SpecialFolder.RecentItems.AbsolutePath		    jsonUFP.value("SendTo") = SpecialFolder.SendTo.AbsolutePath		    jsonUFP.value("SharedApplicationData") = SpecialFolder.SharedApplicationData.AbsolutePath		    jsonUFP.value("SharedApplications") = SpecialFolder.SharedApplications.AbsolutePath		    jsonUFP.value("SharedDesktop") = SpecialFolder.SharedDesktop.AbsolutePath		    jsonUFP.value("SharedDocuments") = SpecialFolder.SharedDocuments.AbsolutePath		    jsonUFP.value("SharedFavorites") = SpecialFolder.SharedFavorites.AbsolutePath		    jsonUFP.value("SharedPreferences") = SpecialFolder.SharedPreferences.AbsolutePath		    jsonUFP.value("SharedStartupItems") = SpecialFolder.SharedStartupItems.AbsolutePath		    jsonUFP.value("SharedTemplates") = SpecialFolder.SharedTemplates.AbsolutePath		    jsonUFP.value("StartupItems") = SpecialFolder.StartupItems.AbsolutePath		    jsonUFP.value("System") = SpecialFolder.System.AbsolutePath		    jsonUFP.value("Templates") = SpecialFolder.Templates.AbsolutePath		    jsonUFP.value("Temporary") = SpecialFolder.Temporary.AbsolutePath		    jsonUFP.value("Trash") = SpecialFolder.Trash.AbsolutePath		    jsonUFP.value("UserHome") = SpecialFolder.UserHome.AbsolutePath		    jsonUFP.value("Windows") = SpecialFolder.Windows.AbsolutePath		  #Endif		  		  // Read in the user preferences under our admin account (Vista/7/MacOS) only		  If Not IsWindowsXP() Then		    		    If Not IsAdmin() Then		      		      // Save user preferences		      Try		        Dim tos As TextOutputStream		        tos = TextOutputStream.Create(fi)		        tos.Write(jsonUFP.ToString())		        tos.Close		      Catch		        MsgBox "Error - Unable to write com.virtuosoft.install.json file."		      End Try		    Else		      		      Try		        #If TargetMacOS		          Dim tis As TextInputStream		          jsonUFP = New JSONItem		          tis = TextInputStream.Open(fi)		          jsonUFP.Load(tis.ReadAll)		          tis.Close		        #EndIf		        		        // Remove the user preferences file		        fi.Delete		      Catch		        		        #If TargetWin32		          		          // If running windows and there is no file, use administrator preferences		          jsonUFP.value("Installer") = App.ExecutableFile.Parent.AbsolutePath		          jsonUFP.value("AppleMenu") = SpecialFolder.AppleMenu.AbsolutePath		          jsonUFP.value("StartMenu") = SpecialFolder.AppleMenu.AbsolutePath		          jsonUFP.value("Applications") = SpecialFolder.Applications.AbsolutePath		          jsonUFP.value("ApplicationData") = SpecialFolder.ApplicationData.AbsolutePath		          jsonUFP.value("Cookies") = SpecialFolder.Cookies.AbsolutePath		          jsonUFP.value("Desktop") = SpecialFolder.Desktop.AbsolutePath		          jsonUFP.value("Documents") = SpecialFolder.Documents.AbsolutePath		          jsonUFP.value("Extensions") = SpecialFolder.Extensions.AbsolutePath		          jsonUFP.value("Favorites") = SpecialFolder.Favorites.AbsolutePath		          jsonUFP.value("Fonts") = SpecialFolder.Fonts.AbsolutePath		          jsonUFP.value("History") = SpecialFolder.History.AbsolutePath		          jsonUFP.value("InternetCache") = SpecialFolder.InternetCache.AbsolutePath		          jsonUFP.value("Music") = SpecialFolder.Music.AbsolutePath		          jsonUFP.value("NetworkPlaces") = SpecialFolder.NetworkPlaces.AbsolutePath		          jsonUFP.value("Pictures") = SpecialFolder.Pictures.AbsolutePath		          jsonUFP.value("Preferences") = SpecialFolder.Preferences.AbsolutePath		          jsonUFP.value("Printers") = SpecialFolder.Printers.AbsolutePath		          jsonUFP.value("RecentItems") = SpecialFolder.RecentItems.AbsolutePath		          jsonUFP.value("SendTo") = SpecialFolder.SendTo.AbsolutePath		          jsonUFP.value("SharedApplicationData") = SpecialFolder.SharedApplicationData.AbsolutePath		          jsonUFP.value("SharedApplications") = SpecialFolder.SharedApplications.AbsolutePath		          jsonUFP.value("SharedDesktop") = SpecialFolder.SharedDesktop.AbsolutePath		          jsonUFP.value("SharedDocuments") = SpecialFolder.SharedDocuments.AbsolutePath		          jsonUFP.value("SharedFavorites") = SpecialFolder.SharedFavorites.AbsolutePath		          jsonUFP.value("SharedPreferences") = SpecialFolder.SharedPreferences.AbsolutePath		          jsonUFP.value("SharedStartupItems") = SpecialFolder.SharedStartupItems.AbsolutePath		          jsonUFP.value("SharedTemplates") = SpecialFolder.SharedTemplates.AbsolutePath		          jsonUFP.value("StartupItems") = SpecialFolder.StartupItems.AbsolutePath		          jsonUFP.value("System") = SpecialFolder.System.AbsolutePath		          jsonUFP.value("Templates") = SpecialFolder.Templates.AbsolutePath		          jsonUFP.value("Temporary") = SpecialFolder.Temporary.AbsolutePath		          jsonUFP.value("Trash") = SpecialFolder.Trash.AbsolutePath		          jsonUFP.value("UserHome") = SpecialFolder.UserHome.AbsolutePath		          jsonUFP.value("Windows") = SpecialFolder.Windows.AbsolutePath		          Return jsonUFP		          		        #Endif		        //MsgBox "Error - Unable to read com.virtuosoft.install.json file." 		      End Try		    End If		  End If		  Return jsonUFP		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub DoAppleScript(sScript As String)		  #If TargetMacOS		    		    // Execute the given AppleScript asynchronously from the temp folder		    Dim fi As FolderItem = SpecialFolder.SharedDocuments.Child("." + App.ExecutableFile.Name + ".scpt")		    Dim tos As TextOutputStream		    If fi.Exists Then fi.Delete		    tos = TextOutputStream.Create(fi)		    sScript = ReplaceAll(sScript, "``",Chr(34))		    tos.Write(sScript)		    tos.Close		    		    // Shell our temp file async		    Dim sh As New Shell		    sh.Mode = 1 ' Async		    Dim sCmd As String = "osascript " + Chr(34) + fi.ShellPath.ReplaceAll("\-","-").ReplaceAll("\+","+").ReplaceAll("\ ", " ") + Chr(34) + " &"		    sh.TimeOut = 30		    sh.Execute(sCmd)		    WaitSeconds 1 ' hang out for at least 1 second		    fi.Delete		  #Endif		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub DoVBScript(sScript As String)		  #If TargetWin32		    // Execute the given VBScript asynchronously from the temp folder		    Dim fi As FolderItem = SpecialFolder.Temporary.Child(App.ExecutableFile.Name + ".vbs")		    Dim tos As TextOutputStream		    If fi.Exists Then fi.Delete		    tos = TextOutputStream.Create(fi)		    tos.Write(sScript)		    tos.Close		    fi.Launch		  #Endif		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function GetMacVersion() As String		  Dim sVer As String		  #If TargetMacOS		    Dim myShell As New Shell		    myShell.Mode = 0		    myShell.Execute "/usr/bin/sw_vers"		    Return myShell.Result		  #EndIf		  Return sVer		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function IsAdmin() As Boolean		  // Determine if we are admin by write attempt to test.txt in the hosts file folder		  Dim tos As TextOutputStream		  Static bCache As Boolean 		  Static bResult As Boolean		  Dim fi As FolderItem		  Dim sHost As String		  		  // Return cached result, no sense in file i/o		  If bCache Then Return bResult		  		  #If TargetMacOS		    		    // MacOS location of hosts file		    sHost = "/private/etc/test.txt"		  #Else		    		    // Windows (NT, 2000, XP, 2003, Vista, 7) location of hosts file		    sHost = SpecialFolder.System.Child("drivers").Child("etc").Child("test.txt").ShellPath		  #EndIf		  		  // Attempt to write test file		  Try		    fi = New FolderItem(sHost, FolderItem.PathTypeShell)		    tos = TextOutputStream.Create(fi)		    tos.Write "Test, you can delete this file"		    tos.Close		    bResult = fi.Exists		    		    // Delete the file if we were able to create it		    If bResult Then fi.Delete		  Catch err As RuntimeException		    bResult = False		  End Try		  bCache = True		  Return bResult		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function IsRoot() As Boolean		  #If DebugBuild Then		    Return True		  #EndIf		  		  // Determin if we have root access		  Var sh As New Shell		  sh.TimeOut = 10000		  #If TargetMacOS		    sh.Execute "whoami"		  #Else		    sh.Execute "net session >nul 2>&1 && echo root"		  #Endif		  		  // Look for "root" in results		  Var sResult As String = sh.Result		  sh.Close		  If sResult.InStr("root") <> 0 Then		    Return True		  Else		    Return False		  End If		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function IsWindowsXP() As Boolean		  #If TargetWin32 Then		    Dim sh As New Shell		    sh.execute "ver"		    If sh.Result.InStr("XP") > 0 Then		      sh.Close		      Return True		    End If		    sh.Close		  #Endif		  Return False		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub LoadInstaller()		  // Check for install.json		  Dim fi As FolderItem = GetAppFolder().Child("libs").Child("install.json")		  If Not fi.Exists Then		    Call MsgBox("Installer cannot continue because of missing install.json file. Click OK to quit.", 16)		    Quit		  End If		  		  // Load install.json data		  Dim jsOptions As JSONItem		  Try		    Dim tis As TextInputStream		    tis = TextInputStream.Open(fi)		    jsInstall = New JSONItem		    jsInstall.Load(tis.ReadAll)		    If jsInstall.HasName("options") Then		      jsOptions = jsInstall.Lookup("options","")		    Else		      Call MsgBox("Installer cannot continue because of missing options in install.json file. Click OK to quit.", 16)		      Quit		    End If		    tis.Close		  Catch		    Call MsgBox("Invalid install.json file format. Click OK to quit.", 16)		    Quit		  End Try		  		  // Fill out the user interface elements		  Me.Title = "Install " + jsInstall.Lookup("title", "Installer")		  txtClickWrap.Text = jsInstall.Lookup("clickWrap",txtClickWrap.Text)		  lblDescription.Text = jsInstall.Lookup("description",lblDescription.Text)		  		  // Fill out the radio option buttons, and enable		  		  // Option 1		  radioOption1.Caption = jsOptions.Child(0).Lookup("name", title)		  Dim jsCheck As JSONItem		  jsCheck = jsOptions.Child(0).Lookup("enable", Nil)		  If jsCheck <> Nil Then		    radioOption1.Enabled = ShellHas(jsCheck.Value(0), jsCheck.Value(1))		  End If		  jsCheck = jsOptions.Child(0).Lookup("disable", Nil)		  If jsCheck <> Nil Then		    radioOption1.Enabled = Not ShellHas(jsCheck.Value(0), jsCheck.Value(1))		  End If		  jsCheck = jsOptions.Child(0).Lookup("default", Nil)		  If jsCheck <> Nil Then		    radioOption1.Value = ShellHas(jsCheck.Value(0), jsCheck.Value(1))		  End If		  		  // Option 2		  If jsOptions.Count > 1 Then		    radioOption2.Caption = jsOptions.Child(1).Lookup("name", title + " option 2")		    radioOption2.Visible = True		    		    jsCheck = jsOptions.Child(1).Lookup("enable", Nil)		    If jsCheck <> Nil Then		      radioOption2.Enabled = ShellHas(jsCheck.Value(0), jsCheck.Value(1))		    End If		    jsCheck = jsOptions.Child(1).Lookup("disable", Nil)		    If jsCheck <> Nil Then		      radioOption2.Enabled = Not ShellHas(jsCheck.Value(0), jsCheck.Value(1))		    End If		    jsCheck = jsOptions.Child(1).Lookup("default", Nil)		    If jsCheck <> Nil Then		      radioOption2.Value = ShellHas(jsCheck.Value(0), jsCheck.Value(1))		    End If		  End If		  		  // Option 3		  If jsOptions.Count > 2 Then		    radioOption3.Caption = jsOptions.Child(2).Lookup("name", title + " option 3")		    radioOption3.Visible = True		    		    jsCheck = jsOptions.Child(2).Lookup("enable", Nil)		    If jsCheck <> Nil Then		      radioOption3.Enabled = ShellHas(jsCheck.Value(0), jsCheck.Value(1))		    End If		    jsCheck = jsOptions.Child(2).Lookup("disable", Nil)		    If jsCheck <> Nil Then		      radioOption3.Enabled = Not ShellHas(jsCheck.Value(0), jsCheck.Value(1))		    End If		    jsCheck = jsOptions.Child(2).Lookup("default", Nil)		    If jsCheck <> Nil Then		      radioOption3.Value = ShellHas(jsCheck.Value(0), jsCheck.Value(1))		    End If		  End If		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub RestartAsAdmin()		  // Restart the installer with admin credentials		  #If TargetMacOS		    		    // Execute the given AppleScript asynchronously from the temp folder		    Dim sScript As String = "delay 2" + Chr(10) + "do shell script " + Chr(34) + App.ExecutableFile.NativePath + Chr(34) + " with administrator privileges" + Chr(10)		    DoAppleScript sScript		    Quit		    		  #Else		    Dim sCmd As String = App.ExecutableFile.AbsolutePath		    sCmd = ReplaceAll(restartvbscript, "[application-binary]", sCmd)		    DoVBScript sCmd		  #EndIf		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Sub RunOption(nIndex As Integer)		  // Get installer details for the selected option		  Try 		    jsOption = jsInstall.Value("options")		    jsOption = jsOption.Child(nIndex)		    Dim jsCmds As JSONItem = jsOption.Value("commands")		    		    // Get all shell commands		    For n As Integer = 0 to jsCmds.Count -1		      Dim jsShell As JSONItem = jsCmds.Value(n)		      Dim sType As String 		      Dim sCmd As String 		      Dim vState As Variant		      sType = jsShell.Value(0)		      If jsShell.Count > 1 Then sCmd = jsShell.Value(1)		      If jsShell.Count > 2 Then vState = jsShell.Value(2)		      shellInstall.Add(sType, sCmd, vState)		    Next n		  Catch JSONException		    Call MsgBox("Unable to load options in install.json file format. Click OK to quit.", 16)		    Quit		  End Try		  		  // Get estimate		  shellInstall.Seconds = Val(jsOption.Lookup("estimate", "120"))		  		  // Run the shell		  shellInstall.Start		  		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function ShellHas(sCmd As String, sContains As String) As Boolean		  // Execute the given command and check for a substring in the result		  Dim myShell As New Shell		  Dim sResult As String		  myShell.Mode = 0		  		  // Replace the given strings shortcodes if present		  For Each sName As String In jsonShortCodes.Names		    sCmd = ReplaceAll(sCmd, "[" + sName + "]", Self.jsonShortCodes.Value(sName))		  Next		  		  myShell.Execute(sCmd)		  sResult = myShell.Result		  myShell.Close		  Return Not (sResult.InStr(sContains) = 0)		  		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub WaitSeconds(nSecs As Integer, Optional Prog As Variant)		  '' This routine simply holds the instruction pointer in the current thread		  '' for the number of seconds specified in nSecs		  Dim nCount As Integer		  Dim rect As RectControl		  while(nCount < nSecs)		    Dim r As Integer		    For r = 1 to 10		      If Prog <> Nil Then		        rect = Prog		        #If TargetMacOS		          rect.Refresh		        #Endif		      End If		      App.DoEvents 100		    Next r		    nCount = nCount + 1		  wend		  		End Sub	#tag EndMethod	#tag Property, Flags = &h0		finishMessage As String	#tag EndProperty	#tag Property, Flags = &h0		jsInstall As JSONItem	#tag EndProperty	#tag Property, Flags = &h0		jsonShortCodes As JSONItem	#tag EndProperty	#tag Property, Flags = &h0		jsOption As JSONItem	#tag EndProperty#tag EndWindowCode#tag Events ppWizard	#tag Event		Sub Change()		  If Me.Value = 3 Then		    Canvas1.Visible = True		  Else		    Canvas1.Visible = False		  End If		End Sub	#tag EndEvent#tag EndEvents#tag Events pbFinish	#tag Event		Sub Action()		  // Attempt to write the install log		  Try 		    Dim fi As FolderItem = GetAppFolder().Child("libs").Child("error.log")		    Dim tos As TextOutputStream		    If fi.Exists Then fi.Delete		    tos = TextOutputStream.Create(fi)		    tos.Write(shellInstall.ConsoleText.Text)		    tos.Close		  Catch		    // Do nothing		    Quit		  End Try		  		  // Finished, close the installer		  Quit		End Sub	#tag EndEvent#tag EndEvents#tag Events pbContinue	#tag Event		Sub Action()		  // Execute the option		  Dim nIndex As Integer = 0		  If radioOption1.Value Then		    If radioOption1.Enabled = False Then Exit		    nIndex = 0		  ElseIf radioOption2.Value Then		    If radioOption2.Enabled = False Then Exit		    nIndex = 1		  Else		    If radioOption3.Enabled = False Then Exit		    nIndex = 2		  End If		  		  ppWizard.Value = 3		  RunOption(nIndex)		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbGoBack	#tag Event		Sub Action()		  // Go back to the clipwrap page		  ppWizard.Value = 1		End Sub	#tag EndEvent#tag EndEvents#tag Events pbAccept	#tag Event		Sub Action()		  // Advance to the options page		  ppWizard.Value = 2		End Sub	#tag EndEvent#tag EndEvents#tag Events pbQuit	#tag Event		Sub Action()		  Quit		End Sub	#tag EndEvent#tag EndEvents#tag Events txtClickWrap	#tag Event		Sub KeyUp(Key As String)		  // Support copy, cut & paste		  #If TargetMacOS Then		    If Keyboard.CommandKey Then		      Dim c As New Clipboard		      If Key = "x" Or Key = "c" Then		        c.SetText Me.Text.Mid(Me.SelStart + 1, Me.SelLength)		        c.Close		        If Not Me.ReadOnly And Key = "x" Then		          Dim nStart As Integer = Me.SelStart		          Me.Text = Me.Text.Mid(0, Me.SelStart + 1) + Me.Text.Mid(Me.SelStart + Me.SelLength + 1,Me.Text.Len())		          Me.SelStart = nStart		          Me.SelLength = 0		        End If		      End If		      If Not Me.ReadOnly And Key = "v" Then		        If c.TextAvailable() Then		          Dim nStart As Integer = Me.SelStart		          Me.Text = Me.Text.Mid(0, Me.SelStart + 1) + c.Text + Me.Text.Mid(Me.SelStart + Me.SelLength + 1,Me.Text.Len())		          Me.SelStart = nStart + c.Text.Len()		          Me.SelLength = 0		        End If		      End If		    End If		  #EndIf		End Sub	#tag EndEvent#tag EndEvents#tag Events pbPrint	#tag Event		Sub Action()		  // Print the contents of the txtClickWrap textbox		  		  // Write the txtClickWrap to a temp file and print it		  #If TargetMacOS		    Dim fi As FolderItem = SpecialFolder.SharedDocuments.Child(Self.Title + ".txt")		  #Else		    Dim fi As FolderItem = SpecialFolder.SharedApplicationData.Child(Self.Title + ".txt")		  #Endif		  Try		    Dim tos As TextOutputStream		    tos = TextOutputStream.Create(fi)		    tos.Write txtClickWrap.Text		    tos.Close		  Catch err As RuntimeException		    MsgBox "Error - unable to write text file to " + fi.ShellPath		  End Try		  		  // Use TextEdit or Notepad to print the text file		  #If TargetMacOS		    DoAppleScript("tell application ``TextEdit`` to print ``" + fi.NativePath + "``")		  #Else		    // Use notepad to print the file		    Dim myShell As New Shell		    myShell.Mode = 0		    myShell.Execute("notepad /p " + Chr(34) + fi.NativePath + Chr(34))		    myShell.Close		  #Endif		  WaitSeconds 5		  Try		    fi.Delete		  Catch		    MsgBox "Error - unable to delete " + fi.ShellPath		  End Try		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbQuitNow	#tag Event		Sub Action()		  // Do not bother restarting with privileges 		  #If TargetMacOS		    Dim fi As FolderItem = SpecialFolder.SharedDocuments.Child(".com.virtuosoft.install.json")		  #Else		    Dim fi As FolderItem = SpecialFolder.SharedApplicationData.Child("com.virtuosoft.install.json")		  #Endif		  		  // Remove the user prefernces file		  fi.Delete		  Try		    fi.Delete		  Catch		    //MsgBox "Error - Unable to remove com.virtuosoft.install.json file."		  End Try		  		  Quit		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbRestart	#tag Event		Sub Action()		  // Restart ourselves with elevated privileges		  //#If Not DebugBuild		  RestartAsAdmin		  Quit		  //#Else		  //ppWizard.Value = 1		  //#Endif		  		End Sub	#tag EndEvent#tag EndEvents#tag Events shellInstall	#tag Event		Sub Finished()		  // Process has finished, let the user click finished		  lblProgress.Text = jsOption.Lookup("finishMessage", "Process complete. Click the Finish button to close the installer.")		  pbFinish.Enabled = True		  		End Sub	#tag EndEvent	#tag Event		Sub Timeout()		  Dim sMsg As String = jsOption.Lookup("timeoutMessage", "The process has timedout. " + Self.Title + " will now quit.")		  If sMsg <> "" Then		    Dim mBox As New MessageDialog		    mBox.Icon = MessageDialog.GraphicNote		    mBox.Message = sMsg		    Call mBox.ShowModal		    Quit		  End If		  		End Sub	#tag EndEvent	#tag Event		Sub Aborted()		  Dim sMsg As String = jsOption.Lookup("abortedMessage", "The process has been aborted. " + Self.Title + " will now quit.")		  If sMsg <> "" Then		    Dim mBox As New MessageDialog		    mBox.Icon = MessageDialog.GraphicNote		    mBox.Message = sMsg		    Call mBox.ShowModal		    Quit		  End If		End Sub	#tag EndEvent#tag EndEvents#tag ViewBehavior	#tag ViewProperty		Name="MinimumWidth"		Visible=true		Group="Size"		InitialValue="64"		Type="Integer"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="MinimumHeight"		Visible=true		Group="Size"		InitialValue="64"		Type="Integer"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="MaximumWidth"		Visible=true		Group="Size"		InitialValue="32000"		Type="Integer"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="MaximumHeight"		Visible=true		Group="Size"		InitialValue="32000"		Type="Integer"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Type"		Visible=true		Group="Frame"		InitialValue="0"		Type="Types"		EditorType="Enum"		#tag EnumValues			"0 - Document"			"1 - Movable Modal"			"2 - Modal Dialog"			"3 - Floating Window"			"4 - Plain Box"			"5 - Shadowed Box"			"6 - Rounded Window"			"7 - Global Floating Window"			"8 - Sheet Window"			"9 - Metal Window"			"11 - Modeless Dialog"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="HasCloseButton"		Visible=true		Group="Frame"		InitialValue="True"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="HasMaximizeButton"		Visible=true		Group="Frame"		InitialValue="True"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="HasMinimizeButton"		Visible=true		Group="Frame"		InitialValue="True"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="HasFullScreenButton"		Visible=true		Group="Frame"		InitialValue="False"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="DefaultLocation"		Visible=true		Group="Behavior"		InitialValue="0"		Type="Locations"		EditorType="Enum"		#tag EnumValues			"0 - Default"			"1 - Parent Window"			"2 - Main Screen"			"3 - Parent Window Screen"			"4 - Stagger"		#tag EndEnumValues	#tag EndViewProperty	#tag ViewProperty		Name="HasBackgroundColor"		Visible=true		Group="Background"		InitialValue="False"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="BackgroundColor"		Visible=true		Group="Background"		InitialValue="&hFFFFFF"		Type="Color"		EditorType="Color"	#tag EndViewProperty	#tag ViewProperty		Name="Backdrop"		Visible=true		Group="Background"		InitialValue=""		Type="Picture"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Composite"		Visible=false		Group="OS X (Carbon)"		InitialValue="False"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="finishMessage"		Visible=false		Group="Behavior"		InitialValue=""		Type="String"		EditorType="MultiLineEditor"	#tag EndViewProperty	#tag ViewProperty		Name="FullScreen"		Visible=false		Group="Behavior"		InitialValue="False"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Height"		Visible=true		Group="Size"		InitialValue="400"		Type="Integer"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="ImplicitInstance"		Visible=true		Group="Behavior"		InitialValue="True"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Interfaces"		Visible=true		Group="ID"		InitialValue=""		Type="String"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="MacProcID"		Visible=false		Group="OS X (Carbon)"		InitialValue="0"		Type="Integer"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="MenuBar"		Visible=true		Group="Menus"		InitialValue=""		Type="MenuBar"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="MenuBarVisible"		Visible=true		Group="Deprecated"		InitialValue="True"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Name"		Visible=true		Group="ID"		InitialValue=""		Type="String"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Resizeable"		Visible=true		Group="Frame"		InitialValue="True"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Super"		Visible=true		Group="ID"		InitialValue=""		Type="String"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Title"		Visible=true		Group="Frame"		InitialValue="Untitled"		Type="String"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Visible"		Visible=true		Group="Behavior"		InitialValue="True"		Type="Boolean"		EditorType=""	#tag EndViewProperty	#tag ViewProperty		Name="Width"		Visible=true		Group="Size"		InitialValue="600"		Type="Integer"		EditorType=""	#tag EndViewProperty#tag EndViewBehavior